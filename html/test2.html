<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Site Immersif - Mode Veille</title>
    <style>
        /* 1. CONFIGURATION DE BASE */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            background-color: #000;
            font-family: 'Segoe UI', sans-serif;
            color: white;
            overflow-x: hidden;
        }

        /* 2. LE CONTENU DU SITE (À CACHER) */
        .content {
            position: relative;
            z-index: 5;
            padding: 50px;
            text-align: center;
            /* Transition douce pour le flou et l'opacité */
            transition: filter 1s ease, opacity 1s ease, transform 1s ease;
        }

        /* 3. LA VIDÉO DE FOND */
        #bg-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0;
            object-fit: contain; /* Garde toute la vidéo visible */
            background-color: black; /* Remplit les bords vides en noir */
            transition: opacity 1s ease;
        }

        /* 4. TON ANIMATION fadeInScale */
        @keyframes fadeInScale {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        /* 5. LE MESSAGE D'INACTIVITÉ */
        #idle-message {
            position: fixed;
            top: 80%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: none;
            text-align: center;
            pointer-events: none;
        }

        /* 6. LES ÉTATS QUAND ON EST INACTIF (IDLE) */
        
        /* On floute et on cache le texte du site */
        body.is-idle .content {
            filter: blur(15px);
            opacity: 0;
            transform: scale(1.05); /* Petit effet de recul */
        }

        /* On affiche la vidéo */
        body.is-idle #bg-video {
            opacity: 1;
        }

        /* On affiche ton message avec ton animation */
        body.is-idle #idle-message {
            display: block;
            animation: fadeInScale 1s ease-out forwards;
        }

    </style>
</head>
<body>

    <video autoplay muted loop playsinline id="bg-video">
        <source src="../videos/tiktok_thomastfu_7589712529983589653.mp4" type="video/mp4">
    </video>

    <div id="idle-message">
        <h2 style="font-size: 4rem;">tema le poulet</h2>
    </div>

    <div class="content">
        <h1>Mon Article de Blog</h1>
        <p>Ceci est le texte important de mon site web.</p>
        <div style="margin-top: 50px;">
            <img src="https://via.placeholder.com/600x300/333/fff?text=Image+du+Site" alt="Exemple">
            <p style="max-width: 600px; margin: 20px auto;">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
                Si vous arrêtez de bouger, ce texte va disparaître 
                et laisser place à une magnifique vidéo spatiale.
            </p>
        </div>
    </div>

    <script>
        const video = document.getElementById('bg-video');
        let idleTimer;
        const IDLE_TIME = 120000; // 2 minutes d'inactivité
        function setIdle() {
            document.body.classList.add('is-idle');

            // On tente d'activer le son
            video.currentTime = 0;
            video.volume = 0.1;
            video.muted = false;
             

            // La lecture d'une vidéo avec son renvoie une "Promesse"
            let playPromise = video.play();

            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    // Le son est autorisé, on ne fait rien de plus
                    console.log("Audio activé avec succès");
                })
                .catch(error => {
                    // SI le navigateur bloque (pas d'interaction), on repasse en MUTE
                    // pour que la vidéo s'affiche quand même !
                    video.muted = true;
                    video.play();
                    console.log("Le son est bloqué par le navigateur, affichage en muet.");
                });
            }
        }

        function setActive() {
            document.body.classList.remove('is-idle');
    
            // On coupe le son dès que l'utilisateur redevient actif
            video.muted = true;

            clearTimeout(idleTimer);
            idleTimer = setTimeout(setIdle, IDLE_TIME);
        }

        // Liste des événements pour détecter l'activité
        ['mousemove', 'keydown', 'scroll', 'click', 'touchstart'].forEach(event => {
            window.addEventListener(event, setActive);
        });

        // Initialisation
        setActive();
    </script>
</body>
</html>